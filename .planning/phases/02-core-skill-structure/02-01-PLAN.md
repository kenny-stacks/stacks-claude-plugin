---
phase: 02-core-skill-structure
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - skills/stacks-dev/references/clarity-design.md
  - skills/stacks-dev/references/clarity-tdd.md
  - skills/stacks-dev/references/clarity-cli.md
  - skills/stacks-dev/references/clarity-frontend.md
autonomous: true

must_haves:
  truths:
    - "Reference files exist for each workflow phase"
    - "Each reference file has table of contents for navigation"
    - "Reference files are under 200 lines each (progressive disclosure)"
    - "Reference files contain domain-specific patterns and examples"
  artifacts:
    - path: "skills/stacks-dev/references/clarity-design.md"
      provides: "Design phase patterns and guidance"
      min_lines: 50
    - path: "skills/stacks-dev/references/clarity-tdd.md"
      provides: "TDD workflow patterns and Clarinet SDK testing"
      min_lines: 50
    - path: "skills/stacks-dev/references/clarity-cli.md"
      provides: "Clarinet CLI commands reference"
      min_lines: 50
    - path: "skills/stacks-dev/references/clarity-frontend.md"
      provides: "Stacks.js frontend integration patterns"
      min_lines: 50
  key_links:
    - from: "skills/stacks-dev/SKILL.md"
      to: "references/*.md"
      via: "markdown links in workflow phases"
      pattern: "\\[references/clarity"
---

<objective>
Create reference files for progressive disclosure in the stacks-dev skill.

Purpose: Provide domain-specific guidance for each workflow phase without bloating SKILL.md (which must stay under 500 lines). Reference files are loaded on-demand when Claude enters each phase or when user requests specific patterns.

Output: Four reference files in references/ subdirectory, each under 200 lines with table of contents.
</objective>

<execution_context>
@/Users/kenny/.claude/get-shit-done/workflows/execute-plan.md
@/Users/kenny/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-core-skill-structure/02-CONTEXT.md
@.planning/phases/02-core-skill-structure/02-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create clarity-design.md reference file</name>
  <files>skills/stacks-dev/references/clarity-design.md</files>
  <action>
Create reference file for the Design phase with:

1. **Table of Contents** at top (required for files >50 lines)
2. **Design Philosophy** section covering:
   - Define data structures first
   - Specify public functions with clear inputs/outputs
   - Consider upgradability patterns from start
3. **Data Structure Patterns** section:
   - Define-data-var for mutable state
   - Define-map for key-value storage
   - Define-constant for immutable values
4. **Function Design Patterns** section:
   - Public functions (state-changing)
   - Read-only functions (queries)
   - Private helper functions
5. **Upgradability Considerations** section:
   - Modular architecture (data vs logic contracts)
   - Dynamic principals pattern
   - Storage optimization (hash storage, minimize on-chain data)
6. **External References** section:
   - Links to Clarity Book sections (not embedded docs)
   - Links to Stacks documentation

Target: 100-150 lines. Keep patterns brief with examples. Link to external docs for deep dives.
  </action>
  <verify>
- File exists at skills/stacks-dev/references/clarity-design.md
- File has table of contents section
- File is between 50-200 lines
- File contains sections for data structures, functions, upgradability
  </verify>
  <done>clarity-design.md exists with design phase guidance, TOC, and external links</done>
</task>

<task type="auto">
  <name>Task 2: Create clarity-tdd.md reference file</name>
  <files>skills/stacks-dev/references/clarity-tdd.md</files>
  <action>
Create reference file for the TDD/Testing phase with:

1. **Table of Contents** at top
2. **TDD Philosophy** section:
   - Write tests before implementation
   - Tests specify expected behavior
   - Red-green-refactor cycle
3. **Clarinet Test Structure** section:
   - Test file location (tests/)
   - Vitest framework basics
   - Test function anatomy
4. **Common Test Patterns** section:
   - Testing public function success cases
   - Testing expected errors (err codes)
   - Testing read-only functions
   - Testing edge cases and boundaries
5. **Coverage Analysis** section:
   - Running `clarinet test --coverage`
   - Interpreting coverage reports
   - Identifying uncovered code
6. **Example Test Template** section:
   - Basic test structure with simnet
   - Calling contract functions
   - Asserting results

Target: 100-150 lines. Include code examples but keep them minimal. Reference Clarinet docs for API details.
  </action>
  <verify>
- File exists at skills/stacks-dev/references/clarity-tdd.md
- File has table of contents section
- File is between 50-200 lines
- File contains TDD patterns and test examples
  </verify>
  <done>clarity-tdd.md exists with TDD workflow guidance and test patterns</done>
</task>

<task type="auto">
  <name>Task 3: Create clarity-cli.md reference file</name>
  <files>skills/stacks-dev/references/clarity-cli.md</files>
  <action>
Create reference file for Clarinet CLI commands with:

1. **Table of Contents** at top
2. **Project Setup** section:
   - `clarinet new <project>` - create new project
   - `clarinet contract new <name>` - add contract
   - Project structure overview
3. **Development Commands** section:
   - `clarinet check` - syntax and type validation
   - `clarinet console` - interactive REPL
   - `clarinet test` - run unit tests
   - `clarinet test --coverage` - with coverage
4. **Local Development** section:
   - `clarinet devnet start` - start local network
   - `clarinet devnet stop` - stop network
   - Devnet configuration basics
5. **Deployment Commands** section:
   - `clarinet deployments generate` - create deployment plan
   - `clarinet deployments apply` - execute deployment
   - Network targets (devnet, testnet, mainnet)
6. **Quick Reference Table** section:
   - Command summary table for quick lookup

Target: 100-150 lines. Focus on most-used commands with brief explanations. Link to official Clarinet docs for full reference.
  </action>
  <verify>
- File exists at skills/stacks-dev/references/clarity-cli.md
- File has table of contents section
- File is between 50-200 lines
- File contains Clarinet commands organized by workflow stage
  </verify>
  <done>clarity-cli.md exists with Clarinet CLI command reference</done>
</task>

<task type="auto">
  <name>Task 4: Create clarity-frontend.md reference file</name>
  <files>skills/stacks-dev/references/clarity-frontend.md</files>
  <action>
Create reference file for frontend integration with:

1. **Table of Contents** at top
2. **Stacks.js Overview** section:
   - @stacks/connect - wallet connection
   - @stacks/transactions - contract calls
   - @stacks/network - network configuration
3. **Wallet Integration** section:
   - Connect wallet pattern
   - Authentication flow
   - User session management
4. **Contract Calls** section:
   - Read-only calls (no signing)
   - Contract call transactions (with signing)
   - Handling transaction results
   - Error handling patterns
5. **Network Configuration** section:
   - Devnet/testnet/mainnet setup
   - Network switching
   - Environment-based configuration
6. **React Patterns** section:
   - Basic hooks pattern
   - State management for contract data
   - Transaction status handling

Target: 100-150 lines. Provide Stacks-specific patterns. Assume basic React knowledge. Link to Stacks.js docs for API details.
  </action>
  <verify>
- File exists at skills/stacks-dev/references/clarity-frontend.md
- File has table of contents section
- File is between 50-200 lines
- File contains Stacks.js patterns and React integration guidance
  </verify>
  <done>clarity-frontend.md exists with frontend integration patterns</done>
</task>

</tasks>

<verification>
After completing all tasks:

1. **File existence check:**
   ```bash
   ls -la skills/stacks-dev/references/
   ```
   Should show 4 .md files

2. **Line count check:**
   ```bash
   wc -l skills/stacks-dev/references/*.md
   ```
   Each file should be 50-200 lines

3. **Table of contents check:**
   ```bash
   head -20 skills/stacks-dev/references/*.md
   ```
   Each file should have ## Contents or ## Table of Contents section

4. **Structure check:**
   Verify each file has sections appropriate to its domain
</verification>

<success_criteria>
1. Four reference files exist in skills/stacks-dev/references/
2. Each file is between 50-200 lines (progressive disclosure compliant)
3. Each file has table of contents for navigation
4. Reference files cover: design patterns, TDD/testing, CLI commands, frontend integration
5. Files link to external authoritative sources (Clarity Book, Stacks docs) rather than embedding
</success_criteria>

<output>
After completion, create `.planning/phases/02-core-skill-structure/02-01-SUMMARY.md`
</output>
